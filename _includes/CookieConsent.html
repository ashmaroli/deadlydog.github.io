<!-- Original code taken from https://jekyllcodex.org/without-plugin/cookie-consent/ then modified. -->
<style>
	#cookie-notice {
		padding: 0.5rem 1rem;
		display: none;
		text-align: center;
		position: fixed;
		bottom: 0;
		width: 100%;
		background: #222;
		color: rgba(255, 255, 255, 0.8);
	}

	#cookie-notice a {
		display: inline-block;
		cursor: pointer;
		margin-left: 0.5rem;
	}

	#cookie-notice-accept {
		background: #07a21c;
		color: white;
	}

	#cookie-notice-more-info {
		background: #007bff;
		color: white;
	}

	#cookie-notice-reject {
		background: #dc3545;
		color: white;
	}

	@media only screen and (max-width: 767px) {
		/* Reduce max width to prevent text running off-screen on some devices. */
		#cookie-notice span {
			width: 80%;
		}
	}
</style>

<div id="cookie-notice">
	<div style="margin-bottom: 0.25rem;">Allow using third party cookies and scripts to improve this website.</div>
	<div>
		<a id="cookie-notice-accept" class="btn btn-primary btn-sm">Approve</a>
		<a id="cookie-notice-more-info" class="btn btn-primary btn-sm" href="/privacy">More info</a>
		<a id="cookie-notice-reject" class="btn btn-primary btn-sm">Deny</a>
	</div>
</div>

<script>
	function createCookie(name, value, days)
	{
		var expires = "";
		if (days)
		{
			var date = new Date();
			date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
			expires = "; expires=" + date.toUTCString();
		}
		document.cookie = name + "=" + value + expires + "; path=/";
	}

	function readCookie(name)
	{
		var nameEQ = name + "=";
		var ca = document.cookie.split(';');
		for (var i = 0; i < ca.length; i++)
		{
			var c = ca[i];
			while (c.charAt(0) == ' ') c = c.substring(1, c.length);
			if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length, c.length);
		}
		return null;
	}

	function eraseCookie(name)
	{
		createCookie(name, "", -1);
	}

	function RunCodeThatRequiresUserToAcceptCookies()
	{
		// Include the code that requires the user to accept cookies before it runs.
		{% include CodeToRunWhenCookiesAreAccepted.js %}
	}

	// Disable our custom cookie consent banner, as it looks like Google displays its own consent automatically
	// for countries that require it: https://umbracocommunity.social/@steve_gibe/111925508834045878
	var useCustomCookieConsentBanner = true;
	if (useCustomCookieConsentBanner)
	{
		if (readCookie('cookie-notice-response') == 'accepted')
		{
			RunCodeThatRequiresUserToAcceptCookies()
		}
		else if (readCookie('cookie-notice-response') == 'rejected')
		{
			// The user has already rejected cookies, so do not show the cookie prompt.
			document.getElementById('cookie-notice').style.display = 'none';
		}
		else
		{
			// Prompt the user to accept cookies.
			document.getElementById('cookie-notice').style.display = 'block';
		}
	}
	else
	{
		RunCodeThatRequiresUserToAcceptCookies()
	}

	document.getElementById('cookie-notice-accept').addEventListener("click", function ()
	{
		// Persist cookie acceptance for 180 days and hide the cookie prompt.
		createCookie('cookie-notice-response', 'accepted', 180);
		document.getElementById('cookie-notice').style.display = 'none';

		// Reload the page so the analytics scripts, etc. are ran on this page, not just future pages.
		// I considered just calling the RunCodeThatRequiresUserToAcceptCookies() function here, but was
		// not sure how that would affect some analytics metrics, like the time to load the page, etc.
		location.reload();
	});

	document.getElementById('cookie-notice-reject').addEventListener("click", function ()
	{
		// Persist cookie rejection for 1 day so they are not continually prompted while navigating, and hide the cookie prompt.
		createCookie('cookie-notice-response', 'rejected', 1);
		document.getElementById('cookie-notice').style.display = 'none';
	});
</script>
