_id: e233c980-6ba6-11eb-a0ae-d3d4917b3465
message: "## Abstract\r\n\r\nI came up with a way to reuse it completely, but still maintain a good context.\r\n\r\nFrom the point of view of the returned objects, they are completely consistent. I use tests to test the two tests to ensure the consistency.\r\n\r\nThere are some differences when the information is displayed directly, which are not enough to affect the function of the test itself.\r\n\r\n## New full reuse Pester test\r\n\r\n```PowerShell\r\nfunction test($context, $it, $arugments) {\r\n    Describe 'Get-WorkingDirectory' {\r\n        Context $context {\r\n            It $it -TestCases $arugments {\r\n                $result = Get-WorkingDirectory -workingDirectoryOption $workingDirectoryOption -customWorkingDirectory $customWorkingDirectory -applicationPath $applicationPath\r\n                $result | Should -Be $expectedWorkingDirectory\r\n            }\r\n        } \r\n    }\r\n}\r\n```\r\n\r\n```PowerShell\r\n$ApplicationDirectoryContext = 'When requesting the Application Directory as the working directory'\r\n\r\ntest -context $ApplicationDirectoryContext -it 'Returns the applications directory when no Custom Working Directory is given' @{ workingDirectoryOption = 'ApplicationDirectory'; customWorkingDirectory = ''; applicationPath = 'C:\\AppDirectory\\MyApp.exe'; expectedWorkingDirectory = 'C:\\AppDirectory' }\r\n\r\ntest -context $ApplicationDirectoryContext -it 'Returns the applications directory when a Custom Working Directory is given' @{ workingDirectoryOption = 'ApplicationDirectory'; customWorkingDirectory = 'C:\\SomeDirectory'; applicationPath = 'C:\\AppDirectory\\MyApp.exe'; expectedWorkingDirectory = 'C:\\AppDirectory' }\r\n\r\n$CustomDirectoryContext = 'When requesting a custom working directory'\r\n\r\ntest -context $CustomDirectoryContext -it 'Returns the custom directory' @{ workingDirectoryOption = 'CustomDirectory'; customWorkingDirectory = ''; applicationPath = 'C:\\AppDirectory\\MyApp.exe'; expectedWorkingDirectory = '' }\r\n\r\ntest -context $CustomDirectoryContext -it 'Returns the custom directory even if its blank' @{ workingDirectoryOption = 'CustomDirectory'; customWorkingDirectory = 'C:\\SomeDirectory'; applicationPath = 'C:\\AppDirectory\\MyApp.exe'; expectedWorkingDirectory = 'C:\\SomeDirectory' }\r\n\r\n```\r\n\r\n## meta test\r\n\r\nThe following code is used to test that the new test is equivalent to the old test.\r\n\r\nDescribe 'meta test' {\r\n    BeforeAll {\r\n        ($pesterInfo = Invoke-Pester -Path '.\\full-reuse-by-andy.Tests.ps1' -PassThru) *>$null\r\n    }\r\n    it '0' {\r\n        $pesterInfo.Passed[0].ExpandedPath | Should -Be 'Get-WorkingDirectory.When requesting the Application Directory as the working directory.Returns the applications directory when no Custom Working Directory is given'\r\n    }\r\n\r\n    It '1' {\r\n        $pesterInfo.Passed[1].ExpandedPath | Should -Be 'Get-WorkingDirectory.When requesting the Application Directory as the working directory.Returns the applications directory when a Custom Working Directory is given'\r\n    }\r\n\r\n    It '2' {\r\n        $pesterInfo.Passed[2].ExpandedPath | Should -Be 'Get-WorkingDirectory.When requesting a custom working directory.Returns the custom directory'\r\n    }\r\n    It '3' {\r\n        $pesterInfo.Passed[3].ExpandedPath | Should -Be 'Get-WorkingDirectory.When requesting a custom working directory.Returns the custom directory even if its blank'\r\n    }\r\n}\r\n\r\n## Subtle differences\r\n\r\nThe information printed to the host when the two test schemes run successfully.\r\n\r\n### Raw\r\n\r\n```OutPut\r\n\r\nDescribing Get-WorkingDirectory\r\n Context When requesting the Application Directory as the working directory\r\n   [+] Returns the applications directory when no Custom Working Directory is given 4ms (2ms|2ms)\r\n   [+] Returns the applications directory when a Custom Working Directory is given 3ms (2ms|1ms)  \r\n Context When requesting a custom working directory\r\n   [+] Returns the custom directory 3ms (2ms|1ms)\r\n   [+] Returns the custom directory even if its blank 3ms (2ms|2ms)\r\nTests completed in 237ms\r\nTests Passed: 4, Failed: 0, Skipped: 0 NotRun: 0\r\n```\r\n\r\n### New\r\n\r\n```OutPut\r\n\r\nDescribing Get-WorkingDirectory\r\n Context When requesting the Application Directory as the working directory\r\n   [+] Returns the applications directory when no Custom Working Directory is given 23ms (21ms|2ms)\r\n\r\nDescribing Get-WorkingDirectory\r\n Context When requesting the Application Directory as the working directory\r\n   [+] Returns the applications directory when a Custom Working Directory is given 4ms (2ms|1ms)  \r\n\r\nDescribing Get-WorkingDirectory\r\n Context When requesting a custom working directory\r\n   [+] Returns the custom directory 4ms (3ms|2ms)\r\n\r\nDescribing Get-WorkingDirectory\r\n Context When requesting a custom working directory\r\n   [+] Returns the custom directory even if its blank 4ms (2ms|1ms)\r\nTests completed in 555ms\r\nTests Passed: 4, Failed: 0, Skipped: 0 NotRun: 0\r\n```"
name: Xin
email: f5499197fe9d88e1ee32a60346614d60
url: ''
hidden: ''
date: '2021-02-10T13:50:07.404Z'
